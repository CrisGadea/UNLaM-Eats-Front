<div *ngIf="loading">Cargando repartos...</div>
<div *ngIf="error" class="text-red-500">{{ error }}</div>

<table *ngIf="!loading && !error" border="1" cellpadding="5" cellspacing="0">
  <thead>
    <tr>
      <th>ID</th>
      <th>Pedido</th>
      <th>Repartidor</th>
      <th>Dirección</th>
      <th>Estado</th>
      <th>Fecha Asignación</th>
      <th>Fecha Entrega</th>
      <th>Observaciones</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let r of repartos">
      <td>{{ r.id }}</td>
      <td>{{ r.idPedido }}</td>
      <td>{{ r.idRepartidor }}</td>
      <td>{{ r.direccionEntrega }}</td>
      <td>
        <select class="p-1 rounded"
                [ngClass]="{
                  'bg-yellow-100 text-yellow-800': r.estado === EstadoReparto.PENDIENTE,
                  'bg-blue-100 text-blue-800': r.estado === EstadoReparto.EN_CAMINO,
                  'bg-green-100 text-green-800': r.estado === EstadoReparto.ENTREGADO
                }"
                [ngModel]="getEstadoString(r.estado)"
                (ngModelChange)="cambiarEstadoSelect(r, $event)"
                [disabled]="r.estado === EstadoReparto.ENTREGADO">
          <option value="PENDIENTE">Pendiente</option>
          <option value="EN_CAMINO">En camino</option>
          <option value="ENTREGADO">Entregado</option>
        </select>
      </td>
      <td>{{ r.fechaAsignacion | date:'short' }}</td>
      <td>{{ r.fechaEntrega ? (r.fechaEntrega | date:'short') : '-' }}</td>
      <td>{{ r.observaciones || '-' }}</td>
      <td>
        <button (click)="eliminarReparto(r.id)">Eliminar</button>
        <button (click)="asignarRepartidor(r.id)">Asignar Repartidor</button>
      </td>
  </tbody>
</table>
